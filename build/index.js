(()=>{"use strict";const e=window.wp.i18n,t=window.wp.editPost,o=window.wp.components,r=window.wp.data,s=window.wp.coreData,a=window.wp.editor,i=window.wp.plugins,n=window.ReactJSXRuntime;(0,i.registerPlugin)("craftedpath-seo-panel",{render:()=>{const s=window.cptSeoData?.siteName||"Default Site Name",i=window.cptSeoData?.divider||"|",{postTitle:l,seoTitle:d,seoDescription:c,seoNoIndex:p}=(0,r.useSelect)((e=>{const{getEditedPostAttribute:t}=e(a.store),o=t("meta")||{};return{postTitle:t("title"),seoTitle:o?._craftedpath_seo_title||"",seoDescription:o?._craftedpath_seo_description||"",seoNoIndex:o?._craftedpath_seo_noindex||!1}}),[]),{editPost:g}=(0,r.useDispatch)(a.store),u=(e,t)=>{g({meta:{[e]:t}})},h=l?`${l} ${i} ${s}`:"",m=d||h,x=c,_=m.length,w=x.length,f=(e,t,o)=>0===e?"default":e<t?"warning":e>o?"error":"success",y=f(_,50,60),T=f(w,50,160),b=e=>{switch(e){case"warning":return"#ffb900";case"error":return"#dc3232";case"success":return"#46b450";default:return"#a0a5aa"}};return(0,n.jsxs)(t.PluginDocumentSettingPanel,{name:"craftedpath-seo-panel",title:(0,e.__)("SEO Settings","craftedpath-toolkit"),className:"craftedpath-seo-panel",children:[(0,n.jsxs)("div",{style:{position:"relative",marginBottom:"16px"},children:[(0,n.jsx)(o.TextControl,{label:(0,e.__)("SEO Title","craftedpath-toolkit"),value:m,hideLabelFromVision:!1,placeholder:h,onChange:e=>u("_craftedpath_seo_title",e),style:{width:"100%",marginBottom:"0",borderBottomColor:b(y),borderBottomWidth:"default"===y?"1px":"2px",borderBottomStyle:"solid"},help:null}),(0,n.jsx)("div",{style:{marginTop:"4px",display:"flex",alignItems:"center"},children:(0,n.jsx)("span",{style:{color:b(y)},children:`${_} / 60 ${(0,e.__)("characters","craftedpath-toolkit")}`})})]}),(0,n.jsxs)("div",{style:{marginTop:"16px",position:"relative"},children:[(0,n.jsx)(o.TextareaControl,{label:(0,e.__)("Meta Description","craftedpath-toolkit"),value:x,hideLabelFromVision:!1,onChange:e=>u("_craftedpath_seo_description",e),style:{width:"100%",marginBottom:"0",borderBottomColor:b(T),borderBottomWidth:"default"===T?"1px":"2px",borderBottomStyle:"solid"},help:null}),(0,n.jsx)("div",{style:{marginTop:"4px",display:"flex",alignItems:"center"},children:(0,n.jsx)("span",{style:{color:b(T)},children:`${w} / 160 ${(0,e.__)("characters","craftedpath-toolkit")}`})})]}),(0,n.jsx)("div",{style:{marginTop:"16px",padding:"16px 16px 8px 16px",backgroundColor:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"6px"},children:(0,n.jsx)(o.ToggleControl,{label:(0,e.__)("Discourage search engines from indexing this page","craftedpath-toolkit"),checked:p,onChange:e=>u("_craftedpath_seo_noindex",e)})})]})},icon:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6Z"})]})});const l=window.wp.element,d=(0,n.jsx)("i",{className:"iconoir-sparks"}),{Fill:c,Slot:p}=(0,o.createSlotFill)("CraftedPathAiToolsPanelSlot");(0,i.registerPlugin)("craftedpath-ai-tools",{render:()=>(0,n.jsxs)(l.Fragment,{children:[(0,n.jsx)(a.PluginSidebarMoreMenuItem,{target:"craftedpath-ai-tools-sidebar",icon:d,children:(0,e.__)("AI Tools","craftedpath-toolkit")}),(0,n.jsx)(a.PluginSidebar,{name:"craftedpath-ai-tools-sidebar",title:(0,e.__)("AI Tools","craftedpath-toolkit"),icon:d,children:(0,n.jsx)(p,{children:t=>t&&0!==t.length?t:(0,n.jsx)(o.PanelBody,{children:(0,e.__)("No AI tools available for this post type or context.","craftedpath-toolkit")})})})]})});const g=c,u=window.cptAiAutoCategorizeData||{},h=u.i18n||{},m=window.cptAiAutoTagData||{},x=m.i18n||{};window.cptAiAutoCategorizeData&&window.cptAiAutoCategorizeData.is_enabled&&((0,i.registerPlugin)("craftedpath-ai-auto-categorize-panel-loader",{render:()=>{if(!u.is_enabled)return null;const[t,i]=(0,l.useState)(!1),[d,c]=(0,l.useState)(""),[p,m]=(0,l.useState)("info"),{postId:x,postType:_,postTitle:w,postContent:f,currentCategories:y,postStatus:T}=(0,r.useSelect)((e=>{const{getCurrentPostId:t,getEditedPostAttribute:o}=e(a.store),{getEntityRecord:r}=e(s.store),i=t(),n=o("type"),l=i&&n?r("postType",n,i):null;return{postId:i,postType:n,postTitle:o("title"),postContent:l?.content?.raw||"",currentCategories:o("categories")||[],postStatus:o("status")}}),[]),{editPost:b}=(0,r.useDispatch)(a.store),{invalidateResolution:A}=(0,r.useDispatch)(s.store);return(0,n.jsx)(g,{children:(0,n.jsxs)(o.PanelBody,{title:(0,e.__)("Auto Categorization","craftedpath-toolkit"),initialOpen:!0,children:[(0,n.jsx)("p",{style:{marginBottom:"1em"},children:(0,e.__)("Automatically assign the most relevant category based on post content.","craftedpath-toolkit")}),(0,n.jsx)(o.Button,{variant:"primary",onClick:()=>{if(!x||"auto-draft"===T)return m("error"),void c(h.needsSaveError||"Please save the post first.");if(!w&&!f)return m("error"),void c(h.noContentError||"Post needs title or content.");i(!0),c(""),m("info");const e={action:"cptk_auto_categorize_post",nonce:u.nonce,post_id:x};window.wp.ajax.post(e).done((e=>{m("success"),c(e.message||"Success!"),console.log("Auto Categorize Success:",e),e.category_id&&e.category_name?(b({categories:[e.category_id]}),A("getEntityRecords",["taxonomy","category",{per_page:-1}])):(m("warning"),c(h.genericError||"Received success, but no category data."))})).fail(((e,t,o)=>{console.error("Auto Categorize Error:",e,t,o);let r=h.genericError||"An error occurred.";e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message?r=e.responseJSON.data.message:e.responseText&&(r=e.responseText.substring(0,100)),m("error"),c(`${h.errorPrefix||"Error:"} ${r}`)})).always((()=>{i(!1)}))},isBusy:t,disabled:t,style:{marginBottom:"1em"},children:t?h.loadingText||"Categorizing...":h.buttonText||"Auto Categorize"}),t&&(0,n.jsx)(o.Spinner,{style:{marginLeft:"8px",verticalAlign:"middle"}}),d&&(0,n.jsx)(o.Notice,{status:p,isDismissible:!0,onRemove:()=>c(""),style:{marginTop:"1em"},children:d})]})})},icon:null}),console.log("AI Auto Categorize Panel Loaded")),window.cptAiAutoTagData&&window.cptAiAutoTagData.is_enabled&&((0,i.registerPlugin)("craftedpath-ai-auto-tag-panel-loader",{render:()=>{if(!m.is_enabled)return null;const[t,i]=(0,l.useState)(!1),[d,c]=(0,l.useState)(""),[p,u]=(0,l.useState)("info"),{postId:h,postType:_,postTitle:w,postContent:f,postStatus:y}=(0,r.useSelect)((e=>{const{getCurrentPostId:t,getEditedPostAttribute:o}=e(a.store),{getEntityRecord:r}=e(s.store),i=t(),n=o("type"),l=i&&n?r("postType",n,i):null;return{postId:i,postType:n,postTitle:o("title"),postContent:l?.content?.raw||"",postStatus:o("status")}}),[]),{editPost:T}=(0,r.useDispatch)(a.store);return(0,n.jsx)(g,{children:(0,n.jsxs)(o.PanelBody,{title:x.panelTitle||"AI Auto Tagging",initialOpen:!0,children:[(0,n.jsx)("p",{style:{marginBottom:"1em"},children:(0,e.__)("Automatically assign relevant tags based on post content.","craftedpath-toolkit")}),(0,n.jsx)(o.Button,{variant:"primary",onClick:()=>{if(!h||"auto-draft"===y)return u("error"),void c(x.needsSaveError||"Please save the post first.");if(!w&&!f)return u("error"),void c(x.noContentError||"Post needs title or content.");i(!0),c(""),u("info");const e={action:"cptk_auto_tag_post",nonce:m.nonce,post_id:h};window.wp.ajax.post(e).done((e=>{console.log("Auto Tag Success:",e),e.tag_term_ids&&e.tag_term_ids.length>0?(u("success"),c(e.message||"Tags assigned!"),T({tags:e.tag_term_ids})):e.tag_term_ids&&0===e.tag_term_ids.length?(u("info"),c(x.noTagsAdded||"No relevant tags suggested."),T({tags:[]})):(u("warning"),c(x.genericError||"Received success, but no tag data."))})).fail((e=>{console.error("Auto Tag Error:",e);let t=x.genericError||"An error occurred.";e.responseJSON?.data?.message?t=e.responseJSON.data.message:e.responseText&&(t=e.responseText.substring(0,100)),u("error"),c(`${x.errorPrefix||"Error:"} ${t}`)})).always((()=>{i(!1)}))},isBusy:t,disabled:t,style:{marginBottom:"1em"},children:t?x.loadingText||"Tagging...":x.buttonText||"Auto Tag Post"}),t&&(0,n.jsx)(o.Spinner,{style:{marginLeft:"8px",verticalAlign:"middle"}}),d&&(0,n.jsx)(o.Notice,{status:p,isDismissible:!0,onRemove:()=>c(""),style:{marginTop:"1em"},children:d})]})})},icon:null}),console.log("AI Auto Tag Panel Loaded"))})();