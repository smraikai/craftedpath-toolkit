(()=>{"use strict";var e,t={586:(e,t,o)=>{const n=window.wp.blocks,r=window.wp.i18n,s=window.wp.blockEditor,i=window.wp.components,a=window.wp.element,l=window.wp.apiFetch;var c=o.n(l);const u=window.wp.data,d=window.ReactJSXRuntime,p=JSON.parse('{"UU":"craftedpath-toolkit/ai-content-generator"}');(0,n.registerBlockType)(p.UU,{edit:function({attributes:e,setAttributes:t,clientId:o}){const l=(0,s.useBlockProps)(),{insertBlocks:p}=(0,u.useDispatch)("core/block-editor"),{blockIndex:h,rootClientId:g}=(0,u.useSelect)((e=>{const{getBlockIndex:t,getBlockRootClientId:n}=e("core/block-editor");return{blockIndex:t(o),rootClientId:n(o)}}),[o]),[f,b]=(0,a.useState)(e.prompt||""),[v,k]=(0,a.useState)(!1),[m,_]=(0,a.useState)(null),[w,x]=(0,a.useState)(null);return(0,a.useEffect)((()=>{t({prompt:f})}),[f]),(0,d.jsx)("div",{...l,children:(0,d.jsxs)(i.PanelBody,{title:(0,r.__)("AI Content Generation","ai-content-generator"),children:[m&&(0,d.jsx)(i.Notice,{status:"error",isDismissible:!0,onRemove:()=>_(null),children:m}),w&&(0,d.jsx)(i.Notice,{status:"success",isDismissible:!0,onRemove:()=>x(null),children:w}),(0,d.jsx)(i.TextareaControl,{label:(0,r.__)("Content Prompt","ai-content-generator"),help:(0,r.__)('Describe the content you want the AI to generate (e.g., "Write a paragraph about the benefits of WordPress", "Create a heading and two paragraphs about block themes").',"ai-content-generator"),value:f,onChange:e=>b(e),rows:5,disabled:v}),(0,d.jsx)(i.Button,{variant:"primary",onClick:()=>{k(!0),_(null),x(null),c()({path:"/craftedpath-toolkit/v1/generate-content",method:"POST",data:{prompt:f}}).then((e=>{if(console.log("API Response Received:",e),e.success&&e.content){console.log("Raw Content from API:",e.content);const t=function(e){if(!e)return[];function t(e){let t=e;return t=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),t=t.replace(/(?<!\*)\*(?!\*)(.*?)(?<!\*)\*(?!\*)/g,"<em>$1</em>"),t=t.replace(/__(.*?)__/g,"<strong>$1</strong>"),t=t.replace(/(?<!_)_(?!_)(.*?)(?<!_)_(?!_)/g,"<em>$1</em>"),t}const o=[],r=e.trim().split("\n");let s=[];return r.forEach(((e,i)=>{const a=e.trim();if(a.startsWith("#")){s.length>0&&(o.push((0,n.createBlock)("core/list",{values:s.join("\n")})),s=[]);let e=0;for(;"#"===a[e];)e++;if(e>0&&e<=6&&" "===a[e]){let r=a.substring(e+1).trim();return void(r&&(r=t(r),o.push((0,n.createBlock)("core/heading",{level:e,content:r}))))}}if(a.startsWith("* ")||a.startsWith("- ")){let e=a.substring(2).trim();return e&&(e=t(e),s.push(`<li>${e}</li>`)),void(i===r.length-1&&s.length>0&&o.push((0,n.createBlock)("core/list",{values:s.join("\n")})))}if(s.length>0&&(o.push((0,n.createBlock)("core/list",{values:s.join("\n")})),s=[]),a){let e=t(a);o.push((0,n.createBlock)("core/paragraph",{content:e}))}})),o}(e.content);if(console.log("Parsed Blocks:",t),t.length>0){const e=h+1;console.log(`Attempting to insert blocks at index ${e} in root ${g||"(root)"}`),p(t,e,g,!1),console.log("insertBlocks dispatch called."),x((0,r.__)("Content generated successfully!","ai-content-generator"))}else console.error("Parsing resulted in zero blocks."),_((0,r.__)("AI generated content, but it could not be parsed into blocks. Check console for details.","ai-content-generator"))}else console.error("API response indicated failure or missing content:",e),_(e.message||(0,r.__)("Received an unexpected response from the API.","ai-content-generator"))})).catch((e=>{console.error("API Fetch Error:",e),_(e.message||(0,r.__)("An error occurred while contacting the AI service.","ai-content-generator"))})).finally((()=>{k(!1)}))},isBusy:v,disabled:v||!f.trim(),children:v?(0,r.__)("Generating...","ai-content-generator"):(0,r.__)("Generate Content","ai-content-generator")}),v&&(0,d.jsx)(i.Spinner,{})]})})},save:function(){return null}})}},o={};function n(e){var r=o[e];if(void 0!==r)return r.exports;var s=o[e]={exports:{}};return t[e](s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,o,r,s)=>{if(!o){var i=1/0;for(u=0;u<e.length;u++){for(var[o,r,s]=e[u],a=!0,l=0;l<o.length;l++)(!1&s||i>=s)&&Object.keys(n.O).every((e=>n.O[e](o[l])))?o.splice(l--,1):(a=!1,s<i&&(i=s));if(a){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[o,r,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={250:0,382:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var r,s,[i,a,l]=o,c=0;if(i.some((t=>0!==e[t]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)var u=l(n)}for(t&&t(o);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},o=globalThis.webpackChunkcraftedpath_toolkit=globalThis.webpackChunkcraftedpath_toolkit||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=n.O(void 0,[382],(()=>n(586)));r=n.O(r)})();